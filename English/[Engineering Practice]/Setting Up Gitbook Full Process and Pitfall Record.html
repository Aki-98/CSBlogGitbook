
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Setting up gitbook full process and pitfall record · CS Blog</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="aki">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../" />
    
    
    <link rel="prev" href="../" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    English
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../">
            
                <a href="../">
            
                    
                    [engineering practice]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.1.1.1" data-path="Setting Up Gitbook Full Process and Pitfall Record.html">
            
                <a href="Setting Up Gitbook Full Process and Pitfall Record.html">
            
                    
                    Setting up gitbook full process and pitfall record
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../">
            
                <a href="../">
            
                    
                    [problem solving]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.2.1" data-path="../[Problem Solving]/The program packaged with PyInstaller that depends on apkutils cannot run.html">
            
                <a href="../[Problem Solving]/The program packaged with PyInstaller that depends on apkutils cannot run.html">
            
                    
                    The program packaged with pyinstaller that depends on apkutils cannot run
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../">
            
                <a href="../">
            
                    
                    [source code reading]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.3.1" data-path="../[Source Code Reading]/[PMS] Why do downgraded system pre-installed applications revert after a reboot.html">
            
                <a href="../[Source Code Reading]/[PMS] Why do downgraded system pre-installed applications revert after a reboot.html">
            
                    
                    [pms] why do downgraded system pre-installed applications revert after a reboot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3.2" data-path="../[Source Code Reading]/[PM] What does passing 0 to PackageManager.getPackageInfo as a Flag mean.html">
            
                <a href="../[Source Code Reading]/[PM] What does passing 0 to PackageManager.getPackageInfo as a Flag mean.html">
            
                    
                    [pm] what does passing 0 to packagemanager.getpackageinfo as a flag mean
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../">
            
                <a href="../">
            
                    
                    [technique investigation]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.4.1" data-path="../[Technique Investigation]/Binder Communication Related.html">
            
                <a href="../[Technique Investigation]/Binder Communication Related.html">
            
                    
                    Binder communication related
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4.2" data-path="../[Technique Investigation]/Brief Introduction to MediaSession and Command Transmission and Support.html">
            
                <a href="../[Technique Investigation]/Brief Introduction to MediaSession and Command Transmission and Support.html">
            
                    
                    Brief introduction to mediasession and command transmission and support
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../">
            
                <a href="../../">
            
                    
                    中文
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【工程实践】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../中文/【工程实践】/搭建Gitbook全流程及踩坑记录.html">
            
                <a href="../../中文/【工程实践】/搭建Gitbook全流程及踩坑记录.html">
            
                    
                    搭建gitbook全流程及踩坑记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【技术调查】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../../中文/【技术调查】/Binder通信相关.html">
            
                <a href="../../中文/【技术调查】/Binder通信相关.html">
            
                    
                    Binder通信相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../../中文/【技术调查】/MediaSession简要介绍和命令传递与支持反馈.html">
            
                <a href="../../中文/【技术调查】/MediaSession简要介绍和命令传递与支持反馈.html">
            
                    
                    Mediasession简要介绍和命令传递与支持反馈
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【源码阅读】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../../中文/【源码阅读】/【PMS】为什么重启后，被降级的系统内置应用会还原.html">
            
                <a href="../../中文/【源码阅读】/【PMS】为什么重启后，被降级的系统内置应用会还原.html">
            
                    
                    【pms】为什么重启后，被降级的系统内置应用会还原
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../../中文/【源码阅读】/【PM】PackageManager.getPackageInfo(">
            
                <span>
            
                    
                    【pm】packagemanager.getpackageinfo()传入0作为flag意味着什么
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【疑难解决】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../../中文/【疑难解决】/pyinstaller打包依赖apkutils的程序无法运行.html">
            
                <a href="../../中文/【疑难解决】/pyinstaller打包依赖apkutils的程序无法运行.html">
            
                    
                    Pyinstaller打包依赖apkutils的程序无法运行
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Setting up gitbook full process and pitfall record</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p><strong>Benefits of Converting a Notes Repository to GitBook:</strong></p>
<ul>
<li>Global text search.</li>
<li>Tree-structured navigation for browsing notes.</li>
</ul>
<hr>
<h1 id="step-1-prepare-the-markdown-notes-repository"><strong>Step 1: Prepare the Markdown Notes Repository</strong></h1>
<p>All the following steps have been automated into a CLI tool, which you can directly run in the command line.</p>
<blockquote>
<p>Code location: <a href="https://github.com/Aki-98/Pre-Gitbook-Cli" target="_blank">https://github.com/Aki-98/Pre-Gitbook-Cli</a></p>
</blockquote>
<hr>
<p><strong>1. Convert all files to Markdown or reference them in Markdown</strong></p>
<p>GitBook can only render Markdown (.md) pages.</p>
<p>If you have PDF files, text files, or source code that you want to display on the GitBook website, here&#x2019;s how:</p>
<ul>
<li><strong>For text files (txt)</strong>: Convert them directly to Markdown format.</li>
<li><strong>For PDF files and source code</strong>: Use references to include them in Markdown files.</li>
</ul>
<p><strong>2. Organize Images</strong></p>
<ul>
<li>You can reference online images in your Markdown files, and they will be displayed on the GitBook website. However, online images might become inaccessible over time. If this is a concern, download and save the images to the repository.</li>
<li>If multiple computers access the same notes repository, image references with absolute paths might differ, causing GitBook to fail in rendering the images. In this case, rewrite the absolute paths or use relative paths instead.</li>
<li>If your notes contain photos of physical books, these images may be large. Moving such images within the repository can unnecessarily increase the size of the <code>.git</code> file. To address this, compress the images to reduce size without significant data loss.</li>
</ul>
<p><strong>3. Prepare <code>SUMMARY.md</code></strong></p>
<p>The <code>SUMMARY.md</code> file is used for the tree-structured navigation on the right-hand side of GitBook.</p>
<p>While the <code>gitbook init</code> command can generate a <code>SUMMARY.md</code>, it often comes with various bugs and cannot generate a complete summary based on all Markdown files.</p>
<p><strong>4. Prepare <code>book.json</code></strong></p>
<p>The <code>book.json</code> file is used to configure the GitBook website, including the title, copyright information, and plugins (e.g., global search).</p>
<p>Here&#x2019;s my configuration for reference:
<a href="https://github.com/Aki-98/CSBlogGitbook/blob/main/book.json" target="_blank">https://github.com/Aki-98/CSBlogGitbook/blob/main/book.json</a></p>
<p><strong>Configuration Explanation:</strong></p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;root&quot;</span>: <span class="hljs-string">&quot;/&quot;</span>, 
    <span class="hljs-string">&quot;gitbook&quot;</span>: <span class="hljs-string">&quot;3.2.3&quot;</span>, 
    <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;CS Blog&quot;</span>, <span class="hljs-comment">// Website title</span>
    <span class="hljs-string">&quot;page&quot;</span>: {
        <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;CS Blog&quot;</span> <span class="hljs-comment">// Website title</span>
    },
    <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;aki&quot;</span>, <span class="hljs-comment">// Author</span>
    <span class="hljs-string">&quot;variables&quot;</span>: {
        <span class="hljs-string">&quot;authorName&quot;</span>: <span class="hljs-string">&quot;aki&quot;</span> <span class="hljs-comment">// Author name</span>
    },
    <span class="hljs-string">&quot;plugins&quot;</span>: [
        <span class="hljs-string">&quot;accordion&quot;</span>, <span class="hljs-comment">// A plugin for collapsible content or expandable sections (accordion effect)</span>
        <span class="hljs-string">&quot;search-pro&quot;</span>, <span class="hljs-comment">// An improved global search plugin providing more powerful search functionality</span>
        <span class="hljs-string">&quot;-search&quot;</span>, <span class="hljs-comment">// Disables the default search plugin (GitBook&apos;s built-in search)</span>
        <span class="hljs-string">&quot;tbfed-pagefooter&quot;</span> <span class="hljs-comment">// A plugin for adding copyright statements and modification time to the page footer</span>
    ],
    <span class="hljs-string">&quot;pluginsConfig&quot;</span>: {
        <span class="hljs-string">&quot;tbfed-pagefooter&quot;</span>: { <span class="hljs-comment">// Adds content to the footer of each file</span>
            <span class="hljs-string">&quot;copyright&quot;</span>: <span class="hljs-string">&quot;Copyright &amp;copy Aki 2024&quot;</span>, <span class="hljs-comment">// Copyright statement</span>
            <span class="hljs-string">&quot;modify_label&quot;</span>: <span class="hljs-string">&quot;modified time:&quot;</span>, 
            <span class="hljs-string">&quot;modift_format&quot;</span>: <span class="hljs-string">&quot;YYYY-MM-DD HH:mm:ss&quot;</span> <span class="hljs-comment">// Format for the modification time</span>
        }
    }
}
</code></pre>
<h1 id="step-2-prepare-the-gitbook-setup-environment">Step 2: Prepare the Gitbook Setup Environment</h1>
<p><em>Alternatively, you can deploy GitBook via CI/CD to skip this step.</em></p>
<p>I followed some online tutorials and encountered many issues.</p>
<blockquote>
<p>This tutorial is too simple. You can take a look to get a general idea, but don&apos;t follow its procedures:</p>
<p><a href="https://tonydeng.github.io/gitbook-zh/" target="_blank">https://tonydeng.github.io/gitbook-zh/</a></p>
<p>This one is more detailed and better:</p>
<p><a href="https://1927344728.github.io/fed-knowledge/tools/Gitbook/" target="_blank">https://1927344728.github.io/fed-knowledge/tools/Gitbook/</a></p>
</blockquote>
<p><strong>0. Preparing for pitfalls</strong></p>
<p>At first, I directly downloaded and installed from the official website:</p>
<blockquote>
<p>Official website: <a href="https://nodejs.org/en" target="_blank">https://nodejs.org/en</a></p>
</blockquote>
<p>However, the version from the official website (v18.x) is too new, causing various adaptation issues with gitbook. Later, I downgraded to v.10.x to use gitbook normally.</p>
<p>I encountered an error when installing gitbook-cli after installing v18.x version of nodejs and calling gitbook init in the command line:</p>
<pre><code>/home/travis/.nvm/versions/node/v12.18.3/lib/node_modules/gitbook-cli/node_modules/npm/node_modules/graceful-fs/polyfills.js:287
      if (cb) cb.apply(this, arguments)
                 ^
TypeError: cb.apply is not a function
    at /home/travis/.nvm/versions/node/v12.18.3/lib/node_modules/gitbook-cli/node_modules/npm/node_modules/graceful-fs/polyfills.js:287:18
    at FSReqCallback.oncomplete (fs.js:169:5)
</code></pre><blockquote>
<p>Solution: <a href="https://stackoverflow.com/questions/64211386/gitbook-cli-install-error-typeerror-cb-apply-is-not-a-function-inside-graceful" target="_blank">https://stackoverflow.com/questions/64211386/gitbook-cli-install-error-typeerror-cb-apply-is-not-a-function-inside-graceful</a></p>
</blockquote>
<p>You need to update the graceful-fs version.</p>
<p>When I tried to update with npm, I encountered another issue where any command would result in an error &quot;ERR! Cannot read property &apos;insert&apos; of undefined&quot;.</p>
<blockquote>
<p>Solution: <a href="https://github.com/npm/cli/issues/4876" target="_blank">https://github.com/npm/cli/issues/4876</a></p>
</blockquote>
<p>You need to change the mirror to <a href="https://registry.npmmirror.com/" target="_blank">https://registry.npmmirror.com</a>. If you also need to set a proxy, there is a tutorial here:</p>
<blockquote>
<p>Setting npm proxy: <a href="https://blog.csdn.net/yanzi1225627/article/details/80247758" target="_blank">https://blog.csdn.net/yanzi1225627/article/details/80247758</a></p>
</blockquote>
<p>After updating, calling any gitbook command resulted in no response, no error, and no information. The local directory remained unchanged. I then downgraded nodejs to 10.x.</p>
<p>During this process, there was also an issue that gitbook and gitbook-cli could not coexist. You need to uninstall gitbook to use gitbook-cli (the command-line tool for gitbook). After installing gitbook-cli, the first time you call the gitbook command, like checking the version with <code>gitbook -V</code>, gitbook-cli will install the corresponding version of gitbook.</p>
<p>Since I got stuck at the &quot;install gitbook&quot; step every time I called the gitbook command and checked online for a solution, I found that you can clone gitbook&apos;s github repository and then install and link it yourself:</p>
<pre><code>git clone https://github.com/GitbookIO/gitbook.git
cd gitbook
npm install
npm link
</code></pre><p>Firstly, the instructions in the gitbook repository say to install with <code>bun</code> instead of <code>npm</code>. Secondly, this installation is equivalent to <code>npm install gitbook</code>, which conflicts with gitbook-cli. Therefore, this method is incorrect.</p>
<p>Here is the correct method:</p>
<p><strong>1. Install nvm (Node.js version manager) and Node.js v10.x</strong></p>
<p>Choose one based on your system:</p>
<pre><code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash

bash
Copy code
wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
</code></pre><p>Install Node.js v10.x and use it:</p>
<pre><code>nvm install 10
nvm use 10
</code></pre><p>I also encountered an issue here. In the above steps, the npm version compatible with Node.js v10.x will be installed. However, I previously used v18.x. After switching to Node.js v10.x, the npm version did not change. Any npm command would result in an error. Later, I switched back to v18, uninstalled npm, which uninstalls the latest version of npm, and then switched to v10.x, allowing me to use the older version of npm.</p>
<pre><code>nvm use 18
npm uninstall npm -g
</code></pre><p>The <code>-g</code> means the operation is carried out globally, which will be used in the following commands.</p>
<p><strong>2. Install and use gitbook-cli &amp; gitbook</strong></p>
<pre><code>npm install gitbook-cli -g
</code></pre><p>The <code>npm install -g</code> command is used to globally install Node.js modules. This means the installed modules will be placed in a specific directory, usually the global <code>node_modules</code> directory of your system, not in the <code>node_modules</code> directory of the current project.</p>
<p>If you don&apos;t use the <code>-g</code> (global) parameter in the <code>npm install</code> command, the command will install the specified package in the <code>node_modules</code> folder of the current project, not in the global environment.</p>
<pre><code>gitbook -V
</code></pre><p>Check the gitbook version. The first time you call any gitbook command, it will attempt to install gitbook.</p>
<p>Running <code>gitbook -V</code> again will show the versions of gitbook-cli and gitbook.</p>
<p>Note: Do not install gitbook with <code>npm install gitbook</code> directly; use gitbook-cli instead.</p>
<p><strong>3. Preview the Gitbook website and make adjustments</strong></p>
<p>Switch the command line to the root directory of your MD source files and run the following command to automatically generate README.md and SUMMARY.md:</p>
<pre><code>gitbook init
</code></pre><p>Note: Do not include the character &quot;#&quot; in the directory names and filenames under the MD files, meaning the generated SUMMARY.md should not contain the &quot;#&quot; character. If it does, it will cause the links in the gitbook page&apos;s left navigation bar to not work.</p>
<p>Also, do not have consecutive curly braces in the MD files, like .</p>
<blockquote>
<p>Related instructions: <a href="https://wkcom.gitee.io/gitbook&#x7684;&#x4F7F;&#x7528;/3&#x3001;gitbook&#x8FDE;&#x7EED;&#x5927;&#x62EC;&#x53F7;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x5F0F;.html" target="_blank">https://wkcom.gitee.io/gitbook%E7%9A%84%E4%BD%BF%E7%94%A8/3%E3%80%81gitbook%E8%BF%9E%E7%BB%AD%E5%A4%A7%E6%8B%AC%E5%8F%B7%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F.html</a></p>
</blockquote>
<p>Adding a space between the curly braces will resolve the issue.</p>
<p>Preview the gitbook website:</p>
<pre><code>gitbook server
</code></pre><p>Open the local port in the browser to view the page:</p>
<pre><code>http://localhost:4000/
</code></pre><h1 id="step-3-set-up-io-online-website">Step 3: Set up .io online website</h1>
<p><em>Alternatively, you can deploy GitBook via CI/CD to skip this step.</em></p>
<p>There are many solutions; I chose to directly upload the static website to Github.</p>
<p>Generate the gitbook static website, run the following command in the root directory of your MD source files:</p>
<pre><code>gitbook build
</code></pre><p>This will generate a <code>_book</code> directory, containing the static website code.</p>
<p>As long as the repository has a <code>gh-pages</code> branch, you can access Gitbook Pages with the following link:</p>
<pre><code>https://githubusername.github.io/reponame
</code></pre><p>So the steps are:</p>
<ol>
<li>Create an empty Github repository.</li>
<li>Check out a <code>gh-pages</code> branch, upload the static website.</li>
<li>I need multiple gitbooks, so I created a subfolder in the root directory and uploaded the corresponding static website in this subfolder.</li>
</ol>
<p>Then, I can access multiple Gitbooks with the following paths:</p>
<pre><code>https://githubusername.github.io/reponame/subfoldername1
https://githubusername.github.io/reponame/subfoldername2
</code></pre><h1 id="step-4-gitbook-cicd"><strong>Step 4: GitBook CI/CD</strong></h1>
<p>You can directly copy the following file into your notes repository:</p>
<p><a href="https://github.com/Aki-98/CSBlogGitbook/blob/main/.github/workflows/deploy.yml" target="_blank">https://github.com/Aki-98/CSBlogGitbook/blob/main/.github/workflows/deploy.yml</a></p>
<p>If the branch of your notes repository is not <code>main</code>, you need to rewrite the triggering condition in the first part of the <code>.yml</code> file:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">on:</span>
<span class="hljs-attr">  push:</span>
<span class="hljs-attr">    branches:</span> 
<span class="hljs-bullet">      -</span> {your_branch}
</code></pre>
<p>Make sure the file is placed in the correct path:
<code>/.github/workflows/deploy.yml</code></p>
<p>Go to <strong>Settings &gt; Developer Settings &gt; Personal access tokens &gt; Fine-grained tokens &gt; Generate New Token</strong> in your GitHub personal account.</p>
<p>For permissions, I set them to the maximum since I am unsure about the minimum required permissions. Feel free to investigate and configure as needed.</p>
<p>Next, navigate to your notes repository&apos;s <strong>Settings &gt; Secrets and variables &gt; Actions</strong>, and create a secret named <code>PERSONAL_TOKEN</code>. Copy the token you generated earlier into this field.</p>
<p>Now, every time you push to the repository, a GitBook webpage will be automatically generated and published to the <code>gh-pages</code> branch of your repository.</p>
<p>You can access the webpage using the following URL format:</p>
<pre><code>https://{your_github_name}.github.io/{repo_name}
</code></pre><p><strong>Detailed Explanation of <code>deploy.yml</code></strong></p>
<p>Who would&#x2019;ve thought writing such a simple YAML file could involve so many pitfalls...</p>
<pre><code class="lang-yaml"><span class="hljs-comment"># Name of the CI/CD task</span>
<span class="hljs-attr">name:</span> Deploy GitBook

<span class="hljs-comment"># Trigger condition: When a user pushes to the `main` branch of this repository</span>
<span class="hljs-attr">on:</span>
<span class="hljs-attr">  push:</span>
<span class="hljs-attr">    branches:</span>
<span class="hljs-bullet">      -</span> main

<span class="hljs-comment"># CI/CD jobs</span>
<span class="hljs-attr">jobs:</span>
<span class="hljs-attr">  deploy:</span>
    <span class="hljs-comment"># Platform for running the CI/CD task: Latest version of Ubuntu</span>
<span class="hljs-attr">    runs-on:</span> ubuntu-latest
<span class="hljs-attr">    steps:</span>
      <span class="hljs-comment"># Step 1: Check out the branch of the notes repository</span>
<span class="hljs-attr">      - name:</span> Checkout code
<span class="hljs-attr">        uses:</span> actions/checkout@v3

      <span class="hljs-comment"># Step 2: Set up a Node.js 12 environment. A lower version is chosen for GitBook compatibility.</span>
<span class="hljs-attr">      - name:</span> Setup Node.js <span class="hljs-number">12</span>
<span class="hljs-attr">        uses:</span> actions/setup-node@v3
<span class="hljs-attr">        with:</span>
<span class="hljs-attr">          node-version:</span> <span class="hljs-string">&apos;12&apos;</span>

      <span class="hljs-comment"># Step 3: Install `graceful-fs` in advance to avoid errors (refer to Step 2 for details)</span>
<span class="hljs-attr">      - name:</span> Install Latest graceful-fs
<span class="hljs-attr">        run:</span> npm install graceful-fs@<span class="hljs-number">4.2</span><span class="hljs-number">.0</span> -g

      <span class="hljs-comment"># Step 4: Install the GitBook CLI tool</span>
<span class="hljs-attr">      - name:</span> Install GitBook CLI
<span class="hljs-attr">        run:</span> npm install gitbook-cli@<span class="hljs-number">2.1</span><span class="hljs-number">.2</span> -g

      <span class="hljs-comment"># Step 5: Install GitBook using the CLI tool</span>
<span class="hljs-attr">      - name:</span> Install GitBook
<span class="hljs-attr">        run:</span> gitbook install

      <span class="hljs-comment"># Step 6: Render and generate the GitBook webpage based on the notes</span>
<span class="hljs-attr">      - name:</span> Build GitBook
<span class="hljs-attr">        run:</span> gitbook build

      <span class="hljs-comment"># Step 7: Deploy the GitBook webpage to the `gh-pages` branch of the repository</span>
      <span class="hljs-comment"># Uses the `peaceiris/actions-gh-pages` GitHub Action. For more usage details, refer to:</span>
      <span class="hljs-comment"># https://github.com/peaceiris/actions-gh-pages</span>
<span class="hljs-attr">      - name:</span> Deploy to GitHub Pages
<span class="hljs-attr">        uses:</span> peaceiris/actions-gh-pages@v3
<span class="hljs-attr">        with:</span>
<span class="hljs-attr">          personal_token:</span> ${{ secrets.PERSONAL_TOKEN }} <span class="hljs-comment"># Use the `PERSONAL_TOKEN` from this repository</span>
<span class="hljs-attr">          publish_dir:</span> ./_book <span class="hljs-comment"># Use the files from the `_book` directory</span>
<span class="hljs-attr">          publish_branch:</span> gh-pages <span class="hljs-comment"># Publish to the `gh-pages` branch</span>
</code></pre>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; Aki 2024 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">modified time:
2025-01-02 08:45:25
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../" class="navigation navigation-prev " aria-label="Previous page: [engineering practice]">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../" class="navigation navigation-next " aria-label="Next page: [problem solving]">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Setting up gitbook full process and pitfall record","level":"1.1.1.1","depth":3,"next":{"title":"[problem solving]","level":"1.1.2","depth":2,"path":"English/README.md","ref":"English/README.md","articles":[{"title":"The program packaged with pyinstaller that depends on apkutils cannot run","level":"1.1.2.1","depth":3,"path":"English/[Problem Solving]/The program packaged with PyInstaller that depends on apkutils cannot run.md","ref":"English/[Problem Solving]/The program packaged with PyInstaller that depends on apkutils cannot run.md","articles":[]}]},"previous":{"title":"[engineering practice]","level":"1.1.1","depth":2,"path":"English/README.md","ref":"English/README.md","articles":[{"title":"Setting up gitbook full process and pitfall record","level":"1.1.1.1","depth":3,"path":"English/[Engineering Practice]/Setting Up Gitbook Full Process and Pitfall Record.md","ref":"English/[Engineering Practice]/Setting Up Gitbook Full Process and Pitfall Record.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["accordion","search-pro","-search","tbfed-pagefooter"],"root":"/","styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy Aki 2024","modify_label":"modified time:","modift_format":"YYYY-MM-DD HH:mm:ss"},"accordion":{},"search-pro":{},"highlight":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"theme":"default","author":"aki","page":{"title":"CS Blog"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"authorName":"aki"},"title":"CS Blog","gitbook":"3.2.3"},"file":{"path":"English/[Engineering Practice]/Setting Up Gitbook Full Process and Pitfall Record.md","mtime":"2025-01-02T08:45:25.468Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-01-02T08:46:03.664Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

